# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ –¥–∞–Ω–Ω—ã–º –∏–∑ CSV)

## üìå **–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**
- –í—Å–µ–≥–æ —Ç–∞–±–ª–∏—Ü: **15**
- –°—Ö–µ–º—ã: **physical**, **business**, **fire**, **audit**

---

## üèóÔ∏è **–°—Ö–µ–º–∞ `physical`** (–§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–ª–µ–∫—Å–∞)

### **1. `complexes`** ‚Äì –ö–æ–º–ø–ª–µ–∫—Å—ã –∑–¥–∞–Ω–∏–π
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á, –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç |
| name | varchar(100) | NOT NULL, UNIQUE | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–∞ |
| description | text | ‚Äì | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |
| address | text | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á: `complexes_pkey`
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π: `complexes_name_key`

---

### **2. `buildings`** ‚Äì –ö–æ—Ä–ø—É—Å–∞/–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–ª–µ–∫—Å–∞
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| complex_id | integer | FK | –°—Å—ã–ª–∫–∞ –Ω–∞ `complexes.id` |
| name | varchar(100) | NOT NULL, UNIQUE | ‚Äì |
| address | text | ‚Äì | ‚Äì |
| floors_count | integer | NOT NULL, CHECK | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∞–∂–µ–π (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å > 0) |
| status | varchar(20) | CHECK | –°—Ç–∞—Ç—É—Å: active, inactive, renovation |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `buildings_pkey`
- FK: `buildings_complex_id_fkey`
- UNIQUE: `buildings_complex_id_name_key`
- CHECK: `buildings_floors_count_check`, `buildings_status_check`

---

### **3. `floors`** ‚Äì –≠—Ç–∞–∂–∏ –∑–¥–∞–Ω–∏–π
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| building_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `buildings.id` |
| number | integer | NOT NULL, UNIQUE | –ù–æ–º–µ—Ä —ç—Ç–∞–∂–∞ (0 –∏ –Ω–∏–∂–µ - –ø–æ–¥–≤–∞–ª—å–Ω—ã–µ, 1 –∏ –≤—ã—à–µ - –Ω–∞–¥–∑–µ–º–Ω—ã–µ) |
| type | varchar(30) | CHECK | –¢–∏–ø —ç—Ç–∞–∂–∞: office, technical, parking, retail |
| plan_image_url | text | ‚Äì | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `floors_pkey`
- FK: `floors_building_id_fkey`
- UNIQUE: `floors_building_id_number_key`
- CHECK: `floors_type_check`

---

### **4. `rooms`** ‚Äì –ü–æ–º–µ—â–µ–Ω–∏—è –Ω–∞ —ç—Ç–∞–∂–∞—Ö
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| floor_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `floors.id` |
| number | varchar(20) | NOT NULL, UNIQUE | –ù–æ–º–µ—Ä –ø–æ–º–µ—â–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–æ–≤—ã–π, –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±—É–∫–≤—ã) |
| area | numeric(10,2) | NOT NULL, CHECK | –ü–ª–æ—â–∞–¥—å –ø–æ–º–µ—â–µ–Ω–∏—è –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∞—Ö |
| type | varchar(30) | CHECK | –¢–∏–ø: office, warehouse, corridor, technical, retail, common |
| status | varchar(20) | CHECK | –°—Ç–∞—Ç—É—Å: free, occupied, reserved, renovation |
| max_tenants | integer | ‚Äì | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `rooms_pkey`
- FK: `rooms_floor_id_fkey`
- UNIQUE: `rooms_floor_id_number_key`
- CHECK: `rooms_area_check`, `rooms_status_check`, `rooms_type_check`

---

### **5. `zones`** ‚Äì –ó–æ–Ω—ã –≤–Ω—É—Ç—Ä–∏ –ø–æ–º–µ—â–µ–Ω–∏–π
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| room_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `rooms.id` |
| name | varchar(100) | NOT NULL, UNIQUE | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–æ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–£ –æ–∫–Ω–∞") |
| description | text | ‚Äì | ‚Äì |
| polygon_coordinates | jsonb | ‚Äì | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª–∏–≥–æ–Ω–∞ –∑–æ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `zones_pkey`
- FK: `zones_room_id_fkey`
- UNIQUE: `zones_room_id_name_key`

---

## üíº **–°—Ö–µ–º–∞ `business`** (–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –∞—Ä–µ–Ω–¥–∞)

### **6. `tenants`** ‚Äì –ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏–π
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| name | varchar(200) | NOT NULL | –ö—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ) |
| legal_name | varchar(200) | ‚Äì | –ü–æ–ª–Ω–æ–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ |
| tax_id | varchar(50) | ‚Äì | –ò–ù–ù |
| contact_person | varchar(100) | ‚Äì | ‚Äì |
| contact_phone | varchar(20) | ‚Äì | ‚Äì |
| contact_email | varchar(100) | ‚Äì | ‚Äì |
| status | varchar(20) | CHECK | –°—Ç–∞—Ç—É—Å: active, inactive, suspended |
| created_at | timestamp | ‚Äì | ‚Äì |
| updated_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `tenants_pkey`
- CHECK: `tenants_status_check`

---

### **7. `contracts`** ‚Äì –î–æ–≥–æ–≤–æ—Ä—ã –∞—Ä–µ–Ω–¥—ã
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| tenant_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `tenants.id` |
| contract_number | varchar(50) | NOT NULL, UNIQUE | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞ (—Ñ–æ—Ä–º–∞—Ç: –î-–ì–ì–ì–ì-‚Ññ) |
| start_date | date | NOT NULL, CHECK | ‚Äì |
| end_date | date | NOT NULL, CHECK | ‚Äì |
| status | varchar(20) | CHECK | ‚Äì |
| monthly_rate | numeric(15,2) | NOT NULL | –û–±—â–∞—è –µ–∂–µ–º–µ—Å—è—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã –≤ —Ä—É–±–ª—è—Ö |
| payment_day | integer | CHECK | –î–µ–Ω—å –º–µ—Å—è—Ü–∞ –æ–ø–ª–∞—Ç—ã (1-31) |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `contracts_pkey`
- FK: `contracts_tenant_id_fkey`
- UNIQUE: `contracts_contract_number_key`
- CHECK: `contracts_check`, `contracts_payment_day_check`, `contracts_status_check`

---

### **8. `placements`** ‚Äì –†–∞–∑–º–µ—â–µ–Ω–∏—è –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ –≤ –ø–æ–º–µ—â–µ–Ω–∏—è—Ö
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| contract_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `contracts.id` |
| room_id | integer | NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `physical.rooms.id` |
| usage_type | varchar(30) | CHECK | ‚Äì |
| area_used | numeric(10,2) | NOT NULL, CHECK | –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–ª–æ—â–∞–¥—å |
| rate | numeric(15,2) | NOT NULL | –°—Ç–∞–≤–∫–∞ –∞—Ä–µ–Ω–¥—ã –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è –≤ —Ä—É–±–ª—è—Ö |
| start_date | date | NOT NULL, CHECK | ‚Äì |
| end_date | date | CHECK | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞—Ä–µ–Ω–¥—ã (NULL - –±–µ—Å—Å—Ä–æ—á–Ω–∞—è) |
| status | varchar(20) | CHECK | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `placements_pkey`
- FK: `placements_contract_id_fkey`
- CHECK: `placements_area_used_check`, `placements_check`, `placements_status_check`, `placements_usage_type_check`

---

### **9. `payments`** ‚Äì –ü–ª–∞—Ç–µ–∂–∏ –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| contract_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `contracts.id` |
| amount | numeric(15,2) | NOT NULL | –°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞ –≤ —Ä—É–±–ª—è—Ö |
| payment_date | date | NOT NULL | ‚Äì |
| period_start | date | NOT NULL, CHECK | –ù–∞—á–∞–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ–º–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ |
| period_end | date | NOT NULL, CHECK | –ö–æ–Ω–µ—Ü –æ–ø–ª–∞—á–∏–≤–∞–µ–º–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ |
| status | varchar(20) | CHECK | –°—Ç–∞—Ç—É—Å: paid, pending, overdue |
| payment_method | varchar(30) | ‚Äì | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `payments_pkey`
- FK: `payments_contract_id_fkey`
- CHECK: `payments_check`, `payments_status_check`

---

## üî• **–°—Ö–µ–º–∞ `fire`** (–°–∏—Å—Ç–µ–º–∞ –ø–æ–∂–∞—Ä–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏)

### **10. `buses`** ‚Äì –®–∏–Ω—ã (–ª–∏–Ω–∏–∏ —Å–≤—è–∑–∏) –ø–æ–∂–∞—Ä–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| name | varchar(50) | NOT NULL, UNIQUE | ‚Äì |
| description | text | ‚Äì | ‚Äì |
| building_id | integer | NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `physical.buildings.id` |
| status | varchar(20) | CHECK | –°—Ç–∞—Ç—É—Å: active, inactive, faulty |
| last_check | timestamp | ‚Äì | –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `buses_pkey`
- UNIQUE: `buses_name_key`
- CHECK: `buses_status_check`

---

### **11. `sensors`** ‚Äì –î–∞—Ç—á–∏–∫–∏ –ø–æ–∂–∞—Ä–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| device_id | varchar(50) | NOT NULL, UNIQUE | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ |
| bus_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `buses.id` |
| room_id | integer | ‚Äì | –°—Å—ã–ª–∫–∞ –Ω–∞ `physical.rooms.id` |
| zone_id | integer | ‚Äì | –°—Å—ã–ª–∫–∞ –Ω–∞ `zones.id` |
| type | varchar(30) | NOT NULL, CHECK | –¢–∏–ø: smoke, heat, manual, gas, water |
| model | varchar(100) | ‚Äì | ‚Äì |
| installation_date | date | NOT NULL | ‚Äì |
| last_maintenance | date | ‚Äì | ‚Äì |
| status | varchar(20) | CHECK | –°—Ç–∞—Ç—É—Å: normal, triggered, disabled, faulty, maintenance |
| battery_level | integer | CHECK | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `sensors_pkey`
- FK: `sensors_bus_id_fkey`
- UNIQUE: `sensors_device_id_key`
- CHECK: `sensors_battery_level_check`, `sensors_status_check`, `sensors_type_check`

---

### **12. `sensor_events`** ‚Äì –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π –¥–∞—Ç—á–∏–∫–æ–≤
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| sensor_id | integer | FK, NOT NULL | –°—Å—ã–ª–∫–∞ –Ω–∞ `sensors.id` |
| event_type | varchar(30) | NOT NULL, CHECK | –¢–∏–ø: triggered, normal, battery_low, disconnected, test |
| old_status | varchar(20) | ‚Äì | ‚Äì |
| new_status | varchar(20) | NOT NULL | ‚Äì |
| value | numeric(10,2) | ‚Äì | –ò–∑–º–µ—Ä–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞) |
| description | text | ‚Äì | ‚Äì |
| resolved_at | timestamp | ‚Äì | –í—Ä–µ–º—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è |
| resolved_by | integer | ‚Äì | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `sensor_events_pkey`
- FK: `sensor_events_sensor_id_fkey`
- CHECK: `sensor_events_event_type_check`

---

### **13. `emergency_scenarios`** ‚Äì –ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | integer | PK, NOT NULL | ‚Äì |
| name | varchar(100) | NOT NULL | ‚Äì |
| description | text | ‚Äì | ‚Äì |
| conditions | jsonb | NOT NULL | –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON |
| actions | jsonb | NOT NULL | –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON |
| priority | integer | CHECK | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 - –Ω–∞–∏–≤—ã—Å—à–∏–π, 10 - –Ω–∏–∑—à–∏–π) |
| is_active | boolean | ‚Äì | ‚Äì |
| created_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `emergency_scenarios_pkey`
- CHECK: `emergency_scenarios_priority_check`

---

## üìä **–°—Ö–µ–º–∞ `audit`** (–ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π)

### **14. `change_log`** ‚Äì –õ–æ–≥ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | bigint | PK, NOT NULL | ‚Äì |
| table_name | varchar(100) | NOT NULL | ‚Äì |
| record_id | integer | NOT NULL | ‚Äì |
| operation | varchar(10) | NOT NULL, CHECK | –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏: INSERT, UPDATE, DELETE |
| old_data | jsonb | ‚Äì | –î–∞–Ω–Ω—ã–µ –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
| new_data | jsonb | ‚Äì | –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
| changed_by | varchar(100) | ‚Äì | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/—Å–∏—Å—Ç–µ–º—ã |
| changed_at | timestamp | ‚Äì | ‚Äì |
| ip_address | inet | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `change_log_pkey`
- CHECK: `change_log_operation_check`

---

### **15. `user_action_log`** ‚Äì –õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-----|-------------|-------------|
| id | bigint | PK, NOT NULL | ‚Äì |
| user_id | integer | ‚Äì | ‚Äì |
| action | varchar(100) | NOT NULL | –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: login, tenant_search) |
| entity_type | varchar(50) | ‚Äì | ‚Äì |
| entity_id | integer | ‚Äì | ‚Äì |
| details | jsonb | ‚Äì | –î–µ—Ç–∞–ª–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON |
| ip_address | inet | ‚Äì | ‚Äì |
| user_agent | text | ‚Äì | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ |
| performed_at | timestamp | ‚Äì | ‚Äì |

**–ò–Ω–¥–µ–∫—Å—ã:**
- PK: `user_action_log_pkey`

---

## üîó **–û—Å–Ω–æ–≤–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏**
1. `complexes` ‚Üê `buildings` ‚Üê `floors` ‚Üê `rooms` ‚Üê `zones`
2. `tenants` ‚Üê `contracts` ‚Üê `placements` ‚Üí `rooms`
3. `contracts` ‚Üê `payments`
4. `buildings` ‚Üê `buses` ‚Üê `sensors` ‚Üí `rooms`, `zones`
5. `sensors` ‚Üê `sensor_events`
6. –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã ‚Üí `change_log` (–∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

**–§–æ—Ä–º–∞—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:** –¢–∞–±–ª–∏—Ü—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Å—Ö–µ–º–∞–º, –∫–æ–ª–æ–Ω–∫–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–æ–≤, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.
